/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'local': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: transcribe_empty'
Arguments: ()
2024-07-16 06:34:51,949 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: transcribe_empty
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:51,986 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 14721032366056049717'
Arguments: ()
2024-07-16 06:34:51,987 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 14721032366056049717
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 15045256331014766579'
Arguments: ()
2024-07-16 06:34:51,988 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 15045256331014766579
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:51.673'
Arguments: ()
2024-07-16 06:34:51,989 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:51.673
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:51.949'
Arguments: ()
2024-07-16 06:34:51,989 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:51.949
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 0.275s'
Arguments: ()
2024-07-16 06:34:51,990 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 0.275s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:51,991 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function_name: transcribe_empty'
Arguments: ()
2024-07-16 06:34:51,991 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function_name: transcribe_empty
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:51,992 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Starting empty transcription at 2024-07-16 06:34:51.673 (+0.000s):'
Arguments: ()
2024-07-16 06:34:51,993 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Starting empty transcription at 2024-07-16 06:34:51.673 (+0.000s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Reading transcription file at 2024-07-16 06:34:51.673 (+0.000s):'
Arguments: ()
2024-07-16 06:34:51,993 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading transcription file at 2024-07-16 06:34:51.673 (+0.000s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Sampling transcription list at 2024-07-16 06:34:51.746 (+0.072s):'
Arguments: ()
2024-07-16 06:34:51,994 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Sampling transcription list at 2024-07-16 06:34:51.746 (+0.072s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Empty transcription completed at 2024-07-16 06:34:51.746 (+0.072s):'
Arguments: ()
2024-07-16 06:34:51,995 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Empty transcription completed at 2024-07-16 06:34:51.746 (+0.072s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:51,995 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: parse_whisperx_output'
Arguments: ()
2024-07-16 06:34:51,998 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: parse_whisperx_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:51,999 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 18361270209985518049'
Arguments: ()
2024-07-16 06:34:52,000 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 18361270209985518049
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 15594977972403925506'
Arguments: ()
2024-07-16 06:34:52,001 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 15594977972403925506
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:51.997'
Arguments: ()
2024-07-16 06:34:52,001 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:51.997
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:51.998'
Arguments: ()
2024-07-16 06:34:52,002 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:51.998
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 0.001s'
Arguments: ()
2024-07-16 06:34:52,002 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 0.001s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:52,003 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function_name: parse_whisperx_output'
Arguments: ()
2024-07-16 06:34:52,003 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function_name: parse_whisperx_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:52,004 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Starting to parse WhisperX output at 2024-07-16 06:34:51.997 (+0.000s):'
Arguments: ()
2024-07-16 06:34:52,004 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Starting to parse WhisperX output at 2024-07-16 06:34:51.997 (+0.000s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Key not found: 'speaker' at 2024-07-16 06:34:51.997 (+0.000s):"
Arguments: ()
2024-07-16 06:34:52,005 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Key not found: 'speaker' at 2024-07-16 06:34:51.997 (+0.000s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished parsing WhisperX output at 2024-07-16 06:34:51.998 (+0.001s):'
Arguments: ()
2024-07-16 06:34:52,006 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished parsing WhisperX output at 2024-07-16 06:34:51.998 (+0.001s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:52,006 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: format_for_output'
Arguments: ()
2024-07-16 06:34:52,007 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: format_for_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:52,008 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 12807218653969339798'
Arguments: ()
2024-07-16 06:34:52,008 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 12807218653969339798
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 18397394918226796121'
Arguments: ()
2024-07-16 06:34:52,009 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 18397394918226796121
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:52.007'
Arguments: ()
2024-07-16 06:34:52,010 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:52.007
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:52.007'
Arguments: ()
2024-07-16 06:34:52,010 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:52.007
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 0.000s'
Arguments: ()
2024-07-16 06:34:52,011 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 0.000s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:52,011 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function_name: format_for_output'
Arguments: ()
2024-07-16 06:34:52,012 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function_name: format_for_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:52,012 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Starting to format output at 2024-07-16 06:34:52.007 (+0.000s):'
Arguments: ()
2024-07-16 06:34:52,013 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Starting to format output at 2024-07-16 06:34:52.007 (+0.000s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished formatting output at 2024-07-16 06:34:52.007 (+0.000s):'
Arguments: ()
2024-07-16 06:34:52,013 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished formatting output at 2024-07-16 06:34:52.007 (+0.000s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:52,014 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: spell_correct'
Arguments: ()
2024-07-16 06:34:54,842 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: spell_correct
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:54,844 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 13135446518623292909'
Arguments: ()
2024-07-16 06:34:54,844 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 13135446518623292909
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 8992424428434449886'
Arguments: ()
2024-07-16 06:34:54,845 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 8992424428434449886
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:52.015'
Arguments: ()
2024-07-16 06:34:54,845 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:52.015
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:54.842'
Arguments: ()
2024-07-16 06:34:54,846 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:54.842
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 2.827s'
Arguments: ()
2024-07-16 06:34:54,847 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 2.827s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:54,847 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function_name: spell_correct'
Arguments: ()
2024-07-16 06:34:54,848 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function_name: spell_correct
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:54,849 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,850 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,850 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,851 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,851 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,852 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,852 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,853 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,854 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,854 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,855 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,856 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,856 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,857 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,858 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,858 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,859 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,860 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,860 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,861 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,861 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,862 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,862 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,863 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,863 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,864 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,865 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,865 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,866 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,866 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,867 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,867 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,868 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,868 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,869 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,869 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,870 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):"
Arguments: ()
2024-07-16 06:34:54,871 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):'
Arguments: ()
2024-07-16 06:34:54,871 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.825s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,872 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,872 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,873 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,873 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,874 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,874 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,875 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,876 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,876 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,877 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,877 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,878 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,878 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,879 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,879 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,880 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,880 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,881 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,881 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,882 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,882 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,883 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,883 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,884 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,885 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,885 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,886 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,886 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,887 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,887 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,888 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,888 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,889 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,889 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,890 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,890 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,891 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,891 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,892 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,893 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,893 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,894 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,894 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,895 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,895 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,896 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,896 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,897 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,897 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,898 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,898 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.840 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,899 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,899 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,900 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,900 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,901 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,901 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,902 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,902 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,903 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,903 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,904 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,904 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,905 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,906 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,906 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,907 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,907 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,908 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,908 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,909 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,909 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,910 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,910 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,911 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,911 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,912 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,912 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,913 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,913 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,914 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,914 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,915 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,915 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,916 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished correcting named entity at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,916 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: "    Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):"
Arguments: ()
2024-07-16 06:34:54,917 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Finished cleaning person's name at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Printing corrections if verbose at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,918 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Printing corrections if verbose at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Applying corrections to transcription list at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,918 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Applying corrections to transcription list at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info(f"    {event.name} at {event_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]} (+{format_duration(event_offset)}):")
Message: '    Spell correction completed at 2024-07-16 06:34:54.841 (+2.826s):'
Arguments: ()
2024-07-16 06:34:54,919 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Spell correction completed at 2024-07-16 06:34:54.841 (+2.826s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 92, in _worker
    work_item.run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 337, in wrapper
    with tracer.start_as_current_span(func.__name__) as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:54,919 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: Step :c_transcription_list'
Arguments: ()
2024-07-16 06:34:54,920 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: Step :c_transcription_list
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:54,924 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 8992424428434449886'
Arguments: ()
2024-07-16 06:34:54,925 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 8992424428434449886
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 18397394918226796121'
Arguments: ()
2024-07-16 06:34:54,925 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 18397394918226796121
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:52.014'
Arguments: ()
2024-07-16 06:34:54,926 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:52.014
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:54.920'
Arguments: ()
2024-07-16 06:34:54,927 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:54.920
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 2.906s'
Arguments: ()
2024-07-16 06:34:54,927 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 2.906s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:54,928 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    parent: formatted_verbatim'
Arguments: ()
2024-07-16 06:34:54,929 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     parent: formatted_verbatim
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e'
Arguments: ()
2024-07-16 06:34:54,929 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    input_name: first_args'
Arguments: ()
2024-07-16 06:34:54,930 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     input_name: first_args
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function: spell_correct'
Arguments: ()
2024-07-16 06:34:54,931 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function: spell_correct
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:54,931 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:54,932 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: Step :formatted_verbatim'
Arguments: ()
2024-07-16 06:34:54,933 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: Step :formatted_verbatim
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:54,934 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 18397394918226796121'
Arguments: ()
2024-07-16 06:34:54,934 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 18397394918226796121
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 15594977972403925506'
Arguments: ()
2024-07-16 06:34:54,935 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 15594977972403925506
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:52.007'
Arguments: ()
2024-07-16 06:34:54,936 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:52.007
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:54.933'
Arguments: ()
2024-07-16 06:34:54,936 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:54.933
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 2.926s'
Arguments: ()
2024-07-16 06:34:54,937 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 2.926s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:54,938 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    parent: parse_transcription'
Arguments: ()
2024-07-16 06:34:54,938 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     parent: parse_transcription
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e'
Arguments: ()
2024-07-16 06:34:54,939 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    input_name: first_args'
Arguments: ()
2024-07-16 06:34:54,939 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     input_name: first_args
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function: format_for_output'
Arguments: ()
2024-07-16 06:34:54,940 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function: format_for_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:54,941 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:54,942 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: 'Span: Step :parse_transcription'
Arguments: ()
2024-07-16 06:34:54,942 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: Step :parse_transcription
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:34:54,943 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Span ID: 15594977972403925506'
Arguments: ()
2024-07-16 06:34:54,944 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 15594977972403925506
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Parent ID: 15045256331014766579'
Arguments: ()
2024-07-16 06:34:54,944 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 15045256331014766579
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"  Start time: {start_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  Start time: 2024-07-16 06:34:51.997'
Arguments: ()
2024-07-16 06:34:54,945 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:51.997
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '  End time: 2024-07-16 06:34:54.942'
Arguments: ()
2024-07-16 06:34:54,946 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:34:54.942
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Duration: 2.946s'
Arguments: ()
2024-07-16 06:34:54,946 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 2.946s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info("  Attributes:")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:34:54,947 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    parent: transcribe'
Arguments: ()
2024-07-16 06:34:54,948 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     parent: transcribe
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e'
Arguments: ()
2024-07-16 06:34:54,948 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    input_name: first_args'
Arguments: ()
2024-07-16 06:34:54,949 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     input_name: first_args
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"    {key}: {value}")
Message: '    function: parse_whisperx_output'
Arguments: ()
2024-07-16 06:34:54,949 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function: parse_whisperx_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info("  Events:")
Message: '  Events:'
Arguments: ()
2024-07-16 06:34:54,950 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
    result = await self.run(input, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    result = await super().run(self._output,run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    result = await child.run(input, child.input_name, run_id)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    with self.tracer.start_as_current_span(f"Step :{self.name}") as span:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self._export_span(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    self.logger.info("")
Message: ''
Arguments: ()
2024-07-16 06:34:54,951 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
Token indices sequence length is longer than the specified maximum sequence length for this model (5752 > 2048). Running this sequence through the model will result in indexing errors
Processing:   0%|          | 0/25 [00:00<?, ?it/s]Processing:   0%|          | 0/25 [00:00<?, ?it/s]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable To disable this warning, you can either:
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
TOKENIZERS_PARALLELISM=(true | false)
TOKENIZERS_PARALLELISMTOKENIZERS_PARALLELISM=(true | false)
=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-07-16 06:35:05,762 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:35:24,199 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:35:42,952 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:02,002 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:03,771 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:28,520 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:36,937 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:39,790 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:48,152 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:53,524 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:36:55,187 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:37:21,606 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:37:29,723 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:37:38,255 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:37:49,449 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:37:57,245 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:37:58,928 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:38:05,447 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:38:10,990 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:38:20,295 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:38:54,453 - httpx - INFO - HTTP Request: POST http://localhost:1234/v1/chat/completions "HTTP/1.1 200 OK"
2024-07-16 06:38:55,624 - __main__ - INFO - Pipeline execution was cancelled
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    start_time = datetime.fromtimestamp(span.start_time / 1e9)
Message: 'Span: step_llm_inference'
Arguments: ()
2024-07-16 06:38:55,640 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: step_llm_inference
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    end_time = datetime.fromtimestamp(span.end_time / 1e9)
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:38:55,686 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    duration_seconds = (span.end_time - span.start_time) / 1e9
Message: '  Span ID: 9883639318723658625'
Arguments: ()
2024-07-16 06:38:55,687 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 9883639318723658625
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
Message: '  Parent ID: 10307373493547983019'
Arguments: ()
2024-07-16 06:38:55,689 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 10307373493547983019
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: '  Start time: 2024-07-16 06:34:54.955'
Arguments: ()
2024-07-16 06:38:55,691 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:54.955
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  End time: 2024-07-16 06:38:55.635'
Arguments: ()
2024-07-16 06:38:55,692 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:38:55.635
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Duration: 4m 0.680s'
Arguments: ()
2024-07-16 06:38:55,694 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 4m 0.680s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:38:55,695 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    function_name: step_llm_inference'
Arguments: ()
2024-07-16 06:38:55,696 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function_name: step_llm_inference
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Events:'
Arguments: ()
2024-07-16 06:38:55,697 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:35:24.207 (+29.253s):'
Arguments: ()
2024-07-16 06:38:55,698 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:35:24.207 (+29.253s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:35:42.957 (+48.002s):'
Arguments: ()
2024-07-16 06:38:55,700 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:35:42.957 (+48.002s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:35:42.957 (+48.003s):'
Arguments: ()
2024-07-16 06:38:55,701 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:35:42.957 (+48.003s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:35:42.959 (+48.005s):'
Arguments: ()
2024-07-16 06:38:55,702 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:35:42.959 (+48.005s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:35:42.959 (+48.005s):'
Arguments: ()
2024-07-16 06:38:55,703 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:35:42.959 (+48.005s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:35:42.960 (+48.006s):'
Arguments: ()
2024-07-16 06:38:55,704 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:35:42.960 (+48.006s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:35:42.962 (+48.007s):'
Arguments: ()
2024-07-16 06:38:55,707 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:35:42.962 (+48.007s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:02.040 (+1m 7.085s):'
Arguments: ()
2024-07-16 06:38:55,708 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:02.040 (+1m 7.085s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:02.041 (+1m 7.086s):'
Arguments: ()
2024-07-16 06:38:55,709 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:02.041 (+1m 7.086s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:02.047 (+1m 7.093s):'
Arguments: ()
2024-07-16 06:38:55,711 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:02.047 (+1m 7.093s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:02.047 (+1m 7.093s):'
Arguments: ()
2024-07-16 06:38:55,712 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:02.047 (+1m 7.093s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:02.051 (+1m 7.096s):'
Arguments: ()
2024-07-16 06:38:55,713 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:02.051 (+1m 7.096s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:02.055 (+1m 7.100s):'
Arguments: ()
2024-07-16 06:38:55,715 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:02.055 (+1m 7.100s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:03.776 (+1m 8.821s):'
Arguments: ()
2024-07-16 06:38:55,716 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:03.776 (+1m 8.821s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:03.778 (+1m 8.823s):'
Arguments: ()
2024-07-16 06:38:55,718 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:03.778 (+1m 8.823s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 5 at 2024-07-16 06:36:03.782 (+1m 8.827s):'
Arguments: ()
2024-07-16 06:38:55,719 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 5 at 2024-07-16 06:36:03.782 (+1m 8.827s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:03.786 (+1m 8.831s):'
Arguments: ()
2024-07-16 06:38:55,720 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:03.786 (+1m 8.831s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:03.786 (+1m 8.831s):'
Arguments: ()
2024-07-16 06:38:55,721 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:03.786 (+1m 8.831s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:03.787 (+1m 8.832s):'
Arguments: ()
2024-07-16 06:38:55,722 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:03.787 (+1m 8.832s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:03.789 (+1m 8.835s):'
Arguments: ()
2024-07-16 06:38:55,723 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:03.789 (+1m 8.835s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:28.528 (+1m 33.574s):'
Arguments: ()
2024-07-16 06:38:55,725 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:28.528 (+1m 33.574s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:28.528 (+1m 33.574s):'
Arguments: ()
2024-07-16 06:38:55,726 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:28.528 (+1m 33.574s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:36:28.530 (+1m 33.576s):'
Arguments: ()
2024-07-16 06:38:55,727 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:36:28.530 (+1m 33.576s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:28.532 (+1m 33.578s):'
Arguments: ()
2024-07-16 06:38:55,728 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:28.532 (+1m 33.578s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:28.533 (+1m 33.578s):'
Arguments: ()
2024-07-16 06:38:55,730 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:28.533 (+1m 33.578s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:28.534 (+1m 33.580s):'
Arguments: ()
2024-07-16 06:38:55,731 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:28.534 (+1m 33.580s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:28.539 (+1m 33.584s):'
Arguments: ()
2024-07-16 06:38:55,732 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:28.539 (+1m 33.584s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:36.997 (+1m 42.042s):'
Arguments: ()
2024-07-16 06:38:55,733 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:36.997 (+1m 42.042s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:36.998 (+1m 42.044s):'
Arguments: ()
2024-07-16 06:38:55,735 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:36.998 (+1m 42.044s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:36:37.001 (+1m 42.047s):'
Arguments: ()
2024-07-16 06:38:55,736 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:36:37.001 (+1m 42.047s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:37.004 (+1m 42.050s):'
Arguments: ()
2024-07-16 06:38:55,737 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:37.004 (+1m 42.050s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:37.005 (+1m 42.050s):'
Arguments: ()
2024-07-16 06:38:55,738 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:37.005 (+1m 42.050s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:37.006 (+1m 42.051s):'
Arguments: ()
2024-07-16 06:38:55,739 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:37.006 (+1m 42.051s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:37.007 (+1m 42.052s):'
Arguments: ()
2024-07-16 06:38:55,741 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:37.007 (+1m 42.052s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:39.840 (+1m 44.885s):'
Arguments: ()
2024-07-16 06:38:55,742 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:39.840 (+1m 44.885s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:39.841 (+1m 44.887s):'
Arguments: ()
2024-07-16 06:38:55,743 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:39.841 (+1m 44.887s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:39.848 (+1m 44.894s):'
Arguments: ()
2024-07-16 06:38:55,744 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:39.848 (+1m 44.894s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:39.849 (+1m 44.894s):'
Arguments: ()
2024-07-16 06:38:55,746 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:39.849 (+1m 44.894s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:39.851 (+1m 44.896s):'
Arguments: ()
2024-07-16 06:38:55,747 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:39.851 (+1m 44.896s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:39.852 (+1m 44.897s):'
Arguments: ()
2024-07-16 06:38:55,748 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:39.852 (+1m 44.897s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:48.171 (+1m 53.216s):'
Arguments: ()
2024-07-16 06:38:55,750 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:48.171 (+1m 53.216s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:48.172 (+1m 53.217s):'
Arguments: ()
2024-07-16 06:38:55,751 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:48.172 (+1m 53.217s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 2 at 2024-07-16 06:36:48.175 (+1m 53.221s):'
Arguments: ()
2024-07-16 06:38:55,752 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 2 at 2024-07-16 06:36:48.175 (+1m 53.221s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:48.180 (+1m 53.226s):'
Arguments: ()
2024-07-16 06:38:55,753 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:48.180 (+1m 53.226s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:48.181 (+1m 53.226s):'
Arguments: ()
2024-07-16 06:38:55,755 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:48.181 (+1m 53.226s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:48.182 (+1m 53.227s):'
Arguments: ()
2024-07-16 06:38:55,756 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:48.182 (+1m 53.227s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:48.186 (+1m 53.231s):'
Arguments: ()
2024-07-16 06:38:55,757 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:48.186 (+1m 53.231s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:53.536 (+1m 58.581s):'
Arguments: ()
2024-07-16 06:38:55,759 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:53.536 (+1m 58.581s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:53.538 (+1m 58.583s):'
Arguments: ()
2024-07-16 06:38:55,760 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:53.538 (+1m 58.583s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:36:53.540 (+1m 58.586s):'
Arguments: ()
2024-07-16 06:38:55,761 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:36:53.540 (+1m 58.586s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:53.543 (+1m 58.589s):'
Arguments: ()
2024-07-16 06:38:55,762 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:53.543 (+1m 58.589s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:53.543 (+1m 58.589s):'
Arguments: ()
2024-07-16 06:38:55,763 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:53.543 (+1m 58.589s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:53.545 (+1m 58.590s):'
Arguments: ()
2024-07-16 06:38:55,764 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:53.545 (+1m 58.590s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:53.546 (+1m 58.591s):'
Arguments: ()
2024-07-16 06:38:55,766 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:53.546 (+1m 58.591s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:36:55.188 (+2m 0.234s):'
Arguments: ()
2024-07-16 06:38:55,767 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:36:55.188 (+2m 0.234s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:55.189 (+2m 0.234s):'
Arguments: ()
2024-07-16 06:38:55,768 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:36:55.189 (+2m 0.234s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:36:55.189 (+2m 0.234s):'
Arguments: ()
2024-07-16 06:38:55,770 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:36:55.189 (+2m 0.234s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:55.189 (+2m 0.235s):'
Arguments: ()
2024-07-16 06:38:55,771 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:55.189 (+2m 0.235s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:55.189 (+2m 0.235s):'
Arguments: ()
2024-07-16 06:38:55,772 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:36:55.189 (+2m 0.235s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:36:55.190 (+2m 0.235s):'
Arguments: ()
2024-07-16 06:38:55,773 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:36:55.190 (+2m 0.235s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:36:55.190 (+2m 0.235s):'
Arguments: ()
2024-07-16 06:38:55,774 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:36:55.190 (+2m 0.235s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:37:21.642 (+2m 26.687s):'
Arguments: ()
2024-07-16 06:38:55,775 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:37:21.642 (+2m 26.687s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:21.653 (+2m 26.699s):'
Arguments: ()
2024-07-16 06:38:55,776 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:21.653 (+2m 26.699s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:37:21.662 (+2m 26.707s):'
Arguments: ()
2024-07-16 06:38:55,777 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:37:21.662 (+2m 26.707s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:21.670 (+2m 26.715s):'
Arguments: ()
2024-07-16 06:38:55,778 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:21.670 (+2m 26.715s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:21.670 (+2m 26.715s):'
Arguments: ()
2024-07-16 06:38:55,780 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:21.670 (+2m 26.715s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:21.671 (+2m 26.716s):'
Arguments: ()
2024-07-16 06:38:55,781 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:21.671 (+2m 26.716s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:37:21.673 (+2m 26.719s):'
Arguments: ()
2024-07-16 06:38:55,782 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:37:21.673 (+2m 26.719s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:37:29.737 (+2m 34.783s):'
Arguments: ()
2024-07-16 06:38:55,783 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:37:29.737 (+2m 34.783s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:29.738 (+2m 34.783s):'
Arguments: ()
2024-07-16 06:38:55,784 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:29.738 (+2m 34.783s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:29.741 (+2m 34.786s):'
Arguments: ()
2024-07-16 06:38:55,785 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:29.741 (+2m 34.786s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:29.741 (+2m 34.786s):'
Arguments: ()
2024-07-16 06:38:55,787 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:29.741 (+2m 34.786s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:29.742 (+2m 34.787s):'
Arguments: ()
2024-07-16 06:38:55,788 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:29.742 (+2m 34.787s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:37:29.743 (+2m 34.789s):'
Arguments: ()
2024-07-16 06:38:55,789 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:37:29.743 (+2m 34.789s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:37:38.260 (+2m 43.305s):'
Arguments: ()
2024-07-16 06:38:55,790 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:37:38.260 (+2m 43.305s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:38.260 (+2m 43.306s):'
Arguments: ()
2024-07-16 06:38:55,792 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:38.260 (+2m 43.306s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 2 at 2024-07-16 06:37:38.261 (+2m 43.306s):'
Arguments: ()
2024-07-16 06:38:55,794 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 2 at 2024-07-16 06:37:38.261 (+2m 43.306s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:38.263 (+2m 43.308s):'
Arguments: ()
2024-07-16 06:38:55,795 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:38.263 (+2m 43.308s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:38.263 (+2m 43.308s):'
Arguments: ()
2024-07-16 06:38:55,796 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:38.263 (+2m 43.308s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:38.264 (+2m 43.309s):'
Arguments: ()
2024-07-16 06:38:55,798 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:38.264 (+2m 43.309s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:37:38.266 (+2m 43.311s):'
Arguments: ()
2024-07-16 06:38:55,799 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:37:38.266 (+2m 43.311s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:37:49.455 (+2m 54.501s):'
Arguments: ()
2024-07-16 06:38:55,801 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:37:49.455 (+2m 54.501s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:49.456 (+2m 54.501s):'
Arguments: ()
2024-07-16 06:38:55,802 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:49.456 (+2m 54.501s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:37:49.457 (+2m 54.503s):'
Arguments: ()
2024-07-16 06:38:55,803 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:37:49.457 (+2m 54.503s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:49.459 (+2m 54.504s):'
Arguments: ()
2024-07-16 06:38:55,804 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:49.459 (+2m 54.504s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:49.459 (+2m 54.505s):'
Arguments: ()
2024-07-16 06:38:55,805 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:49.459 (+2m 54.505s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:49.460 (+2m 54.506s):'
Arguments: ()
2024-07-16 06:38:55,807 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:49.460 (+2m 54.506s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:37:49.462 (+2m 54.507s):'
Arguments: ()
2024-07-16 06:38:55,808 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:37:49.462 (+2m 54.507s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:37:57.255 (+3m 2.300s):'
Arguments: ()
2024-07-16 06:38:55,809 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:37:57.255 (+3m 2.300s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:57.255 (+3m 2.301s):'
Arguments: ()
2024-07-16 06:38:55,811 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:57.255 (+3m 2.301s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:37:57.257 (+3m 2.302s):'
Arguments: ()
2024-07-16 06:38:55,812 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:37:57.257 (+3m 2.302s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:57.260 (+3m 2.306s):'
Arguments: ()
2024-07-16 06:38:55,813 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:57.260 (+3m 2.306s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:57.260 (+3m 2.306s):'
Arguments: ()
2024-07-16 06:38:55,814 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:57.260 (+3m 2.306s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:57.267 (+3m 2.312s):'
Arguments: ()
2024-07-16 06:38:55,815 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:57.267 (+3m 2.312s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:37:57.268 (+3m 2.314s):'
Arguments: ()
2024-07-16 06:38:55,816 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:37:57.268 (+3m 2.314s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:37:58.929 (+3m 3.974s):'
Arguments: ()
2024-07-16 06:38:55,817 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:37:58.929 (+3m 3.974s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:58.929 (+3m 3.974s):'
Arguments: ()
2024-07-16 06:38:55,819 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:37:58.929 (+3m 3.974s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:37:58.929 (+3m 3.975s):'
Arguments: ()
2024-07-16 06:38:55,820 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:37:58.929 (+3m 3.975s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:58.930 (+3m 3.975s):'
Arguments: ()
2024-07-16 06:38:55,821 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:58.930 (+3m 3.975s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:58.930 (+3m 3.975s):'
Arguments: ()
2024-07-16 06:38:55,822 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:37:58.930 (+3m 3.975s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:37:58.930 (+3m 3.976s):'
Arguments: ()
2024-07-16 06:38:55,823 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:37:58.930 (+3m 3.976s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:37:58.931 (+3m 3.976s):'
Arguments: ()
2024-07-16 06:38:55,824 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:37:58.931 (+3m 3.976s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:38:05.455 (+3m 10.500s):'
Arguments: ()
2024-07-16 06:38:55,825 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:38:05.455 (+3m 10.500s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:05.455 (+3m 10.500s):'
Arguments: ()
2024-07-16 06:38:55,826 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:05.455 (+3m 10.500s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:38:05.455 (+3m 10.501s):'
Arguments: ()
2024-07-16 06:38:55,827 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:38:05.455 (+3m 10.501s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:05.458 (+3m 10.504s):'
Arguments: ()
2024-07-16 06:38:55,829 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:05.458 (+3m 10.504s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:05.458 (+3m 10.504s):'
Arguments: ()
2024-07-16 06:38:55,830 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:05.458 (+3m 10.504s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:05.460 (+3m 10.505s):'
Arguments: ()
2024-07-16 06:38:55,831 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:05.460 (+3m 10.505s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:38:05.461 (+3m 10.506s):'
Arguments: ()
2024-07-16 06:38:55,832 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:38:05.461 (+3m 10.506s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:38:10.994 (+3m 16.039s):'
Arguments: ()
2024-07-16 06:38:55,833 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:38:10.994 (+3m 16.039s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:10.994 (+3m 16.040s):'
Arguments: ()
2024-07-16 06:38:55,834 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:10.994 (+3m 16.040s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    API calls completed. Number of responses: 1 at 2024-07-16 06:38:10.995 (+3m 16.040s):'
Arguments: ()
2024-07-16 06:38:55,835 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     API calls completed. Number of responses: 1 at 2024-07-16 06:38:10.995 (+3m 16.040s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:10.996 (+3m 16.042s):'
Arguments: ()
2024-07-16 06:38:55,836 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:10.996 (+3m 16.042s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:10.996 (+3m 16.042s):'
Arguments: ()
2024-07-16 06:38:55,837 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:10.996 (+3m 16.042s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:10.997 (+3m 16.042s):'
Arguments: ()
2024-07-16 06:38:55,838 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:10.997 (+3m 16.042s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:38:10.998 (+3m 16.043s):'
Arguments: ()
2024-07-16 06:38:55,839 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:38:10.998 (+3m 16.043s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:38:20.303 (+3m 25.348s):'
Arguments: ()
2024-07-16 06:38:55,840 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:38:20.303 (+3m 25.348s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:20.303 (+3m 25.349s):'
Arguments: ()
2024-07-16 06:38:55,841 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:20.303 (+3m 25.349s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:20.313 (+3m 25.359s):'
Arguments: ()
2024-07-16 06:38:55,843 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:20.313 (+3m 25.359s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:20.313 (+3m 25.359s):'
Arguments: ()
2024-07-16 06:38:55,844 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:20.313 (+3m 25.359s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:20.316 (+3m 25.361s):'
Arguments: ()
2024-07-16 06:38:55,845 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:20.316 (+3m 25.361s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:38:20.319 (+3m 25.365s):'
Arguments: ()
2024-07-16 06:38:55,846 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:38:20.319 (+3m 25.365s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    LLM API call successful at 2024-07-16 06:38:54.469 (+3m 59.514s):'
Arguments: ()
2024-07-16 06:38:55,847 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     LLM API call successful at 2024-07-16 06:38:54.469 (+3m 59.514s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:54.470 (+3m 59.515s):'
Arguments: ()
2024-07-16 06:38:55,848 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/system_prompt.txt at 2024-07-16 06:38:54.470 (+3m 59.515s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:54.482 (+3m 59.528s):'
Arguments: ()
2024-07-16 06:38:55,849 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:54.482 (+3m 59.528s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:54.483 (+3m 59.528s):'
Arguments: ()
2024-07-16 06:38:55,850 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Reading prompt from file: services/prompt_normalisation_v0.txt at 2024-07-16 06:38:54.483 (+3m 59.528s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Prompt file read successfully at 2024-07-16 06:38:54.484 (+3m 59.530s):'
Arguments: ()
2024-07-16 06:38:55,851 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Prompt file read successfully at 2024-07-16 06:38:54.484 (+3m 59.530s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Attempt 1 to call LLM API at 2024-07-16 06:38:54.487 (+3m 59.533s):'
Arguments: ()
2024-07-16 06:38:55,852 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Attempt 1 to call LLM API at 2024-07-16 06:38:54.487 (+3m 59.533s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 354, in wrapper
    @functools.wraps(func)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    event_offset = (event.timestamp - span.start_time) / 1e9
Message: ''
Arguments: ()
2024-07-16 06:38:55,853 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    start_time = datetime.fromtimestamp(span.start_time / 1e9)
Message: 'Span: Step :c_verbatim_output'
Arguments: ()
2024-07-16 06:38:55,856 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: Step :c_verbatim_output
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    end_time = datetime.fromtimestamp(span.end_time / 1e9)
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:38:55,857 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    duration_seconds = (span.end_time - span.start_time) / 1e9
Message: '  Span ID: 10307373493547983019'
Arguments: ()
2024-07-16 06:38:55,859 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 10307373493547983019
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
Message: '  Parent ID: 15045256331014766579'
Arguments: ()
2024-07-16 06:38:55,860 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 15045256331014766579
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: '  Start time: 2024-07-16 06:34:54.952'
Arguments: ()
2024-07-16 06:38:55,861 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:54.952
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  End time: 2024-07-16 06:38:55.855'
Arguments: ()
2024-07-16 06:38:55,862 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:38:55.855
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Duration: 4m 0.903s'
Arguments: ()
2024-07-16 06:38:55,863 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 4m 0.903s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:38:55,864 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    parent: transcribe'
Arguments: ()
2024-07-16 06:38:55,866 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     parent: transcribe
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e'
Arguments: ()
2024-07-16 06:38:55,867 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    input_name: first_args'
Arguments: ()
2024-07-16 06:38:55,868 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     input_name: first_args
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    function: step_llm_inference'
Arguments: ()
2024-07-16 06:38:55,869 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function: step_llm_inference
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Events:'
Arguments: ()
2024-07-16 06:38:55,870 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    event_offset = (event.timestamp - span.start_time) / 1e9
Message: ''
Arguments: ()
2024-07-16 06:38:55,871 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    start_time = datetime.fromtimestamp(span.start_time / 1e9)
Message: 'Span: Step :transcribe'
Arguments: ()
2024-07-16 06:38:55,874 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: Step :transcribe
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    end_time = datetime.fromtimestamp(span.end_time / 1e9)
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:38:55,876 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    duration_seconds = (span.end_time - span.start_time) / 1e9
Message: '  Span ID: 15045256331014766579'
Arguments: ()
2024-07-16 06:38:55,877 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 15045256331014766579
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
Message: '  Parent ID: 14287038272922667051'
Arguments: ()
2024-07-16 06:38:55,878 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: 14287038272922667051
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: '  Start time: 2024-07-16 06:34:51.672'
Arguments: ()
2024-07-16 06:38:55,880 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:51.672
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  End time: 2024-07-16 06:38:55.874'
Arguments: ()
2024-07-16 06:38:55,881 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:38:55.874
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Duration: 4m 4.201s'
Arguments: ()
2024-07-16 06:38:55,883 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 4m 4.201s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:38:55,884 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e'
Arguments: ()
2024-07-16 06:38:55,885 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    input_name: first_args'
Arguments: ()
2024-07-16 06:38:55,887 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     input_name: first_args
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    function: transcribe_empty'
Arguments: ()
2024-07-16 06:38:55,888 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     function: transcribe_empty
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Events:'
Arguments: ()
2024-07-16 06:38:55,889 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 422, in run
    async def run(self,input_value,input_name:str, run_id):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    event_offset = (event.timestamp - span.start_time) / 1e9
Message: ''
Arguments: ()
2024-07-16 06:38:55,891 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 89, in _export_span
    start_time = datetime.fromtimestamp(span.start_time / 1e9)
Message: 'Span: Pipeline :pipe'
Arguments: ()
2024-07-16 06:38:55,893 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - Span: Pipeline :pipe
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 90, in _export_span
    end_time = datetime.fromtimestamp(span.end_time / 1e9)
Message: '  Trace ID: 199440043985718119188250813278924485887'
Arguments: ()
2024-07-16 06:38:55,894 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Trace ID: 199440043985718119188250813278924485887
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 91, in _export_span
    duration_seconds = (span.end_time - span.start_time) / 1e9
Message: '  Span ID: 14287038272922667051'
Arguments: ()
2024-07-16 06:38:55,895 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Span ID: 14287038272922667051
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 92, in _export_span
Message: '  Parent ID: None'
Arguments: ()
2024-07-16 06:38:55,897 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Parent ID: None
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 93, in _export_span
    self.logger.info(f"Span: {span.name}")
Message: '  Start time: 2024-07-16 06:34:51.672'
Arguments: ()
2024-07-16 06:38:55,898 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Start time: 2024-07-16 06:34:51.672
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 94, in _export_span
    self.logger.info(f"  Trace ID: {span.context.trace_id}")
Message: '  End time: 2024-07-16 06:38:55.893'
Arguments: ()
2024-07-16 06:38:55,900 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   End time: 2024-07-16 06:38:55.893
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 95, in _export_span
    self.logger.info(f"  Span ID: {span.context.span_id}")
Message: '  Duration: 4m 4.220s'
Arguments: ()
2024-07-16 06:38:55,901 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Duration: 4m 4.220s
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 96, in _export_span
    self.logger.info(f"  Parent ID: {span.parent.span_id if span.parent else None}")
Message: '  Attributes:'
Arguments: ()
2024-07-16 06:38:55,903 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Attributes:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 98, in _export_span
    self.logger.info(f"  End time: {end_time.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}")
Message: '    run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e'
Arguments: ()
2024-07-16 06:38:55,904 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     run_id: 8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 99, in _export_span
    self.logger.info(f"  Duration: {format_duration(duration_seconds)}")
Message: '  Events:'
Arguments: ()
2024-07-16 06:38:55,905 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -   Events:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    Pipeline : pipe execution completed at 2024-07-16 06:38:55.892 (+4m 4.220s):'
Arguments: ()
2024-07-16 06:38:55,907 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     Pipeline : pipe execution completed at 2024-07-16 06:38:55.892 (+4m 4.220s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 103, in _export_span
    self.logger.info("  Events:")
Message: '    No output due to exception at 2024-07-16 06:38:55.892 (+4m 4.220s):'
Arguments: ()
2024-07-16 06:38:55,908 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO -     No output due to exception at 2024-07-16 06:38:55.892 (+4m 4.220s):
--- Logging error ---
Traceback (most recent call last):
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 570, in use_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1091, in start_as_current_span
    yield span
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 236, in start
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 450, in run
    self.__future_output.set_result(self._output)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 262, in run
    try:
         
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 438, in run
    args = []
              
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 357, in wrapper
    tracer = trace.get_tracer(tracer_name_func())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/nlp_steps.py", line 321, in step_llm_inference
    inflist = await c_llm_inference.LLM_inference(input_text)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 196, in LLM_inference
    results = await self.parallel_inference(segments)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 187, in parallel_inference
    await asyncio.gather(*tasks)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 149, in queue_api_calls
    responses = await asyncio.gather(*tasks)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/LLM_inf.py", line 106, in infer_llm
    async with self.semaphore:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 14, in __aenter__
    await self.acquire()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/locks.py", line 386, in acquire
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 464, in format
    return self._format(record)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 460, in _format
    return self._fmt % values
           ~~~~~~~~~~^~~~~~~~
KeyError: 'levellevel'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 706, in format
    s = self.formatMessage(record)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 675, in formatMessage
    return self._style.format(record)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/logging/__init__.py", line 466, in format
    raise ValueError('Formatting field not found in record: %s' % e)
ValueError: Formatting field not found in record: 'levellevel'
Call stack:
  File "/Users/chrysostomebeltran/Downloads/exercise/test_logs2.py", line 101, in <module>
    asyncio.run(main())
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 651, in run_until_complete
    self.run_forever()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 618, in run_forever
    self._run_once()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/base_events.py", line 1951, in _run_once
    handle._run()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 229, in start
    self.outputs = dict()
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1085, in start_as_current_span
    with trace_api.use_span(
  File "/Users/chrysostomebeltran/anaconda3/envs/gitverse/lib/python3.12/contextlib.py", line 155, in __exit__
    self.gen.throw(value)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 597, in use_span
    span.end()
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 934, in end
    self._span_processor.on_end(self._readable_span())
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 168, in on_end
    sp.on_end(span)
  File "/Users/chrysostomebeltran/Downloads/exercise/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 113, in on_end
    self.span_exporter.export((span,))
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 81, in export
    self.logger = logger
  File "/Users/chrysostomebeltran/Downloads/exercise/workflows/pipeline.py", line 106, in _export_span
    event_offset = (event.timestamp - span.start_time) / 1e9
Message: ''
Arguments: ()
2024-07-16 06:38:55,910 - run_8ffc2df4-5d5b-4a1f-98cf-a8c22b1bca9e - INFO - 

